function select_bubble(e){if(!flag_locked_cam){if($(".bubble_mass,.bubble_titre,.link").hide(),$(".bubble").fadeTo(0,.25),$(".bubble_titre span").css("font-weight","inherit"),$(".bubble_container").css("z-index","0"),$("#b"+e+" .bubble_mass,#b"+e+" .bubble_titre").show(),$("#b"+e+" .bubble").fadeTo(0,1),$("#b"+e+" .bubble_titre span").css("font-weight","bold"),$("#b"+e).css("z-index","2"),array_bubbles_subselected=[],0!=$("div[id^=l"+e+"-]").length)for(var b=0;b<$("div[id^=l"+e+"-]").length;b++){var s=$("div[id^=l"+e+"-]")[b].id,t=s.split("-")[1];$("#b"+t+" .bubble_titre,#b"+t+" .bubble_mass").show(),$("#b"+t+" .bubble").fadeTo(0,1),$("#b"+t).css("z-index","1"),array_bubbles_subselected.push(t)}if(0!=$("div[id$=-"+e+"]").length)for(var b=0;b<$("div[id$=-"+e+"]").length;b++){var s=$("div[id$=-"+e+"]")[b].id,i=s.split("-")[0].substring(1);$("#b"+i+" .bubble_titre,#b"+i+" .bubble_mass").show(),$("#b"+i+" .bubble").fadeTo(0,1),$("#b"+i).css("z-index","1"),array_bubbles_subselected.push(i)}flag_clicked_bubble=!0,id_bubble_selected=e,$(".bubble_physics").hide(),$("#bp"+e).show()}}function zoom_bubble(e,b){if(!flag_locked_cam){var s=[];if(s.push($("#b"+e)),b)for(var t=0;t<$(".bubble_container").length;t++){var e=$(".bubble_container")[t].id.substring(1);s.push($("#b"+e))}else{if(0!=$("div[id^=l"+e+"-]").length)for(var t=0;t<$("div[id^=l"+e+"-]").length;t++){var i=$("div[id^=l"+e+"-]")[t].id,l=i.split("-")[1];s.push($("#b"+l))}if(0!=$("div[id$=-"+e+"]").length)for(var t=0;t<$("div[id$=-"+e+"]").length;t++){var i=$("div[id$=-"+e+"]")[t].id,a=i.split("-")[0].substring(1);s.push($("#b"+a))}}if(s.length>1){for(var n=1e5,u=-1e5,r=1e5,o=-1e5,t=0;t<s.length;t++){var c=s[t].css("left"),d=s[t].css("bottom");c=c.substring(0,c.length-2),d=d.substring(0,d.length-2),n=Math.min(c,n),u=Math.max(c,u),r=Math.min(d,r),o=Math.max(d,o)}var _=s[0].css("left"),f=s[0].css("bottom");_=_.substring(0,_.length-2),f=f.substring(0,f.length-2);var h=Math.abs(o-f),p=Math.abs(f-r),m=Math.abs(_-n),g=Math.abs(u-_),v=$("#app_container").width(),x=$("#app_container").height(),y=75;x-=2*y,v-=2*y;var k=Math.max(h,p),M=Math.max(m,g),w=x/(2*k),z=v/(2*M),j=Math.min(w,z);j=Math.floor(100*j)/100}else j=1;changeZoom(j,!1)}}function focus_bubble(e){select_bubble(e),zoom_bubble(e,!1),map_focus_on_bubble(e)}function unselect_bubble(){flag_clicked_bubble&&!flag_locked_cam&&(array_bubbles_subselected=[],$(".link").fadeOut(1e3),$(".bubble_mass,.bubble_titre").fadeOut(1e3),$(".bubble_titre span").css("font-weight","inherit"),$(".bubble_container").css("z-index","0"),$(".bubble").fadeTo(1e3,1),flag_clicked_bubble=!1,id_bubble_selected=null,$(".bubble_physics").hide())}function update(){$.ajax({url:"./json/bubbles.json",success:function(e){var b=JSON.parse(e);for(i in b)$("#b"+b[i].id).css("left",b[i].x+"px").css("bottom",b[i].y+"px"),$("#bp"+b[i].id+" span").html("Position : <b>( "+Math.round(b[i].x)+" ; "+Math.round(b[i].y)+" )</b><br>\n				Vitesse : <b>( "+Math.round(100*b[i].vx)/100+" ; "+Math.round(100*b[i].vy)/100+" )</b>")}}),$.ajax({url:"./json/links.json",success:function(e){var b=JSON.parse(e);for(i in b)$("#l"+b[i].id).css("left",b[i].x+"px").css("bottom",b[i].y+"px").css("width",b[i].l+"px"),$("#l"+b[i].id).rotate(b[i].angle_deg)}}),setTimeout(update,6e4)}var flag_locked_cam=!1,id_bubble_locked="",flag_clicked_bubble=!1,id_bubble_selected=null,array_bubbles_subselected=[];$(document).on("click",".bubble,.bubble_titre,.bubble_mass",function(){var e=angular.element($("#app_container")).scope();e.$apply(function(){e.search=""}),$(".ui-autocomplete").hide();var b=$(this).parent().attr("id").substring(1);focus_bubble(b)}),$(document).on({mouseenter:function(){var e=$(this).parent().attr("id").substring(1);$("#b"+e+" .bubble_mass,#b"+e+" .bubble_titre").show(),$("#b"+e+" .bubble").fadeTo(0,1),$("#b"+e).css("z-index","3"),$(".bubble_physics").hide(),$("#bp"+e).show()},mouseleave:function(){var e=$(this).parent().attr("id").substring(1);id_bubble_selected==e?$("#b"+e).css("z-index","2"):-1!=array_bubbles_subselected.indexOf(e)?$("#b"+e).css("z-index","1"):($("#b"+e+" .bubble_mass,#b"+e+" .bubble_titre").hide(),null!=id_bubble_selected&&$("#b"+e+" .bubble").fadeTo(0,.25),$("#b"+e).css("z-index","0")),flag_clicked_bubble?($(".bubble_physics").hide(),$("#bp"+id_bubble_selected).show()):$(".bubble_physics").hide()}},".bubble,.bubble_titre,.bubble_mass"),$(document).on("dblclick","#app_container",function(){if(flag_clicked_bubble)unselect_bubble();else if(""!=$("#menu_search").val()){var e=angular.element($("#app_container")).scope();e.$apply(function(){e.search=""})}else map_focus(0,0),zoom_bubble(72,!0)}),jQuery.fn.rotate=function(e){return $(this).css({"-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)",transform:"rotate("+e+"deg)"}),$(this)},jQuery.fn.translate=function(e,b){return $(this).css({"-webkit-transform":"translate("+e+"px,"+b+"px)","-moz-transform":"translate("+e+"px,"+b+"px)","-ms-transform":"translate("+e+"px,"+b+"px)",transform:"translate("+e+"px,"+b+"px)"}),$(this)},jQuery.fn.scale=function(e,b){return $(this).css({"-webkit-transform":"scale("+e+","+b+")","-moz-transform":"scale("+e+","+b+")","-ms-transform":"scale("+e+","+b+")",transform:"scale("+e+","+b+")"}),$(this)};